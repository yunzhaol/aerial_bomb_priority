---
title: "Bayesian Insights into Aerial Bombing Strategies: An Ordered Logistic Regression Analysis of WWII Target Prioritization Against Germany"
author: 
  - Yunzhao Li
thanks: "Code and data are available at: https://github.com/yunzhaol/aerial_bomb_priority.git."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(arrow)
library(knitr)
library(kableExtra)
library(modelsummary)
library(rstanarm)
library(tidyverse)
library(ggplot2)
library(bayesplot)
library(broom)
```


# Introduction

Target selection in WWII aerial campaigns was a crucial aspect that had far-reaching implications for the war’s outcome. This paper aims to dissect the multi-faceted considerations behind target prioritization using Bayesian statistical modeling, providing insights into historical strategies as well as methodological implications for contemporary analysis. We use @citeR and @rohan.

The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

The data for this study was meticulously curated from declassified military records, comprising numerous raids, their targets, and associated strategic variables.

```{r}
#| warning: false
#| message: false
#| echo: false
#| label: tbl-cesdata1
#| tbl-cap: "2022 CES (Cooperative Election Study) Data (Cultural)"

# Load in data
cleaned_aerial_priority <- read_parquet(here::here("data/analysis_data/cleaned_aerial_priority.parquet"))

# Random sampling if needed
set.seed(131)
sampled_aerial_data <- cleaned_aerial_priority %>%
  sample_n(5000)

# ces2022_1 |>
#   head() |>
#   kable(
#     col.names = c("Voted For (2020)", "Age Group", "Gender", "Education", "Race", "Religion"),
#     booktabs = TRUE
  # )
```

```{r}
#| label: fig-bills
#| fig-cap: Bills of penguins
#| echo: false

```

## Variable

Our analysis focuses on the following variables: target priority, target industry, country of the mission's origin, total tons of bombs dropped, and the number of aircraft partaking in the mission.

```{r}
#| label: fig-planes
#| fig-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false

# cleaned_aerial_priority <- read_parquet("data/analysis_data/cleaned_aerial_priority.parquet")
# head(cleaned_aerial_priority)
```

```{r}
#| fig-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false
# cleaned_aerial_priority |>
#   ggplot(aes(x = width, y = length)) +
#   geom_point(alpha = 0.8) +
#   theme_minimal() +
#   labs(x = "Wing width (mm)",
#        y = "Wing length (mm)")
```

## Justification

The selected variables are integral for understanding the strategic matrix that guided target selection, enabling a thorough investigation into the strategic landscape of WWII aerial campaigns.


# Model

The goal of our modelling strategy is twofold. Firstly,...

We constructed a Bayesian ordered logistic regression model to analyze the nuanced hierarchy in target prioritization, utilizing the rstanarm package to accommodate the ordinal nature of target priority levels.

Our model statistically infers the relationship between target priority and various strategic factors, providing a probabilistic assessment of their impacts.

Background details and diagnostics are included in [Appendix -@sec-model-details].


## Model set-up

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

The analysis revealed distinct patterns in target prioritization, highlighting the role of industry type and the mission’s originating country in determining target selection, while the impact of tonnage and aircraft numbers was relatively subdued. @tbl-modelresults.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

# Load in models
aerial_priority_model <-
  readRDS(file = here::here("models/aerial_priority_model.rds"))
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

# Print the summary of the model to inspect the results
print(summary(aerial_priority_model))

# Optional: Plot the effects to visualize the model results
plot(aerial_priority_model)

prior_summary(aerial_priority_model)

```

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
# Extract model coefficients and their posterior distributions
posterior <- as.array(aerial_priority_model)

# Set the color scheme for plots
color_scheme_set("brightblue")

# Plot the credible intervals for model coefficients, focusing on categorical predictors and their impact on ordered levels of priority
mcmc_intervals(posterior, pars = c("tgt_industryunidentified targets", "country_flying_missionusa"), prob = 0.9) +
  labs(title = "Credible Intervals for Model Coefficients",
       subtitle = "90% Credible Intervals showcasing the influence of categorical predictors on ordered priority levels",
       x = "Coefficient Estimate",
       y = "Parameters")

```



# Discussion

## First discussion point {#sec-first-point}

The implications of our study stretch beyond historical curiosity, offering a lens through which modern strategic decisions can be evaluated, and the methodology refined.

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

pp_check(aerial_priority_model) +
  theme_classic() +
  theme(legend.position = "bottom")

posterior_vs_prior(aerial_priority_model) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom") +
  coord_flip()
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

plot(aerial_priority_model, "trace")

plot(aerial_priority_model, "rhat")
```



\newpage


# References


